{% extends "trips/trip.html" %}

{% block add-sublist %}{% endblock %}
{% block trip-buttons %}{% endblock %}


{% block registration %}
<h3>I miei dati</h3>
<table class="table table-striped table-bordered table-hover table-condensed">
  <tr>
    <th>Nome</th>
    <td>{{ user.get_full_name }}</td>
  </tr>
  <tr>
    <th>Credito residuo</th>
    <td class="{{ user.member.balance_class }}">{{ user.member.balance }} €</td>
  </tr>
</table>

<h3>Le mie iscrizioni</h3>

    <form action="" method="post">
      {% csrf_token %}
      {% if error %}
          <ul class="errorlist">
            <li>{{ error }}</li>
          </ul>
      {% endif %}
      {% if message %}
          <ul class="messagelist">
            <li>{{ message }}</li>
          </ul>
      {% endif %}
      <table class="table table-striped table-bordered table-hover table-condensed">
        <tr>
          <th>Cognome e nome</th>
          <th>Socio?</th>
          <th>Caparra</th>
          <th>Stato</th>
        </tr>

        {% for participant in participants %}
        <tr>
          <td>{{ participant.name }}</td>
          <td style="text-align: center">{{ participant.is_member_icon }}</td>
          <td style="text-align: center">{{ participant.deposit }} €</td>
          {% if participant.with_reservation %}
            <td class="red">Con riserva</td>
          {% else %}
            <td class="green">Confermato</td>
          {% endif %}
        </tr>
        {% endfor %}

        {% if registration_allowed %}
            <tr>
              <td>{{ form.name.errors }}{{ form.name }}</td>
              <td style="text-align: center">{{ form.is_member.errors }}{{ form.is_member }}</td>
              <td style="text-align: center">{{trip.deposit}} €</td>
              <td>
                <button type="submit" class="btn btn-block btn-sm btn-default">
                  <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                  Iscrivi
                </button>
              </td>
            </tr>
        {% endif %}
      </table>
    </form>
</div>
{% endblock %}
