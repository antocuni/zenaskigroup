{% extends "trips/trip.html" %}

{% block add-sublist %}{% endblock %}
{% block trip-buttons %}{% endblock %}


{% block registration %}
<h3>I miei dati</h3>
<table class="table table-striped table-bordered table-hover table-condensed">
  <tr>
    <th>Nome</th>
    <td colspan="2">{{ user.get_full_name }}</td>
  </tr>
  <tr>
    <th>Credito residuo</th>
    <td class="{{ user.member.balance_class }}">{{ user.member.balance }} €</td>
  </tr>
</table>

<h3>Le mie iscrizioni</h3>

    <form action="" method="post">
      {% csrf_token %}
      {% if error %}
        <div class="alert alert-danger">
          {{ error }}
        </div>
      {% endif %}
      {% if message %}
        <div class="alert alert-success">
          {{ message }}
        </div>
      {% endif %}
      <table class="table table-striped table-bordered table-hover table-condensed vertical-middle">
        <tr>
          <th>Cognome e nome</th>
          <th>Socio?</th>
          <th>Caparra</th>
          <th>Stato</th>
        </tr>

        {% for participant in participants %}
        <tr>
          <td>{{ participant.name }}</td>
          <td class="text-center">
            {% if participant.is_member %}
              <span class="glyphicon glyphicon-ok-sign text-success"></span>
            {% else %}
              <span class="glyphicon glyphicon-minus-sign text-danger"></span>
            {% endif %}
          </td>
          <td class="text-center">{{ participant.deposit }} €</td>
          {% if participant.with_reservation %}
            <td class="text-warning">Con riserva</td>
          {% else %}
            <td class="text-success">Confermato</td>
          {% endif %}
        </tr>
        {% endfor %}

        {% if registration_allowed %}
            <tr>
              <td class="row-no-padding">
                {{ form.surname.errors }}{{ form.name.errors }}
                <div class="col-sm-6">{{ form.surname }}</div>
                <div class="col-sm-6">{{ form.name }}</div>
              </td>
              <td class="text-center">{{ form.is_member.errors }}{{ form.is_member }}</td>
              <td class="text-center">
                {% if user.member.trusted %}
                  {{ form.deposit.errors }}{{ form.deposit}}
                {% else %}
                  {{ trip.deposit }} €
                  {{ form.deposit.errors }}{{ form.deposit.as_hidden }}
                {% endif %}
              </td>

              <td></td>
            </tr>

        {% endif %}
      </table>

      {% if registration_allowed %}
      <div class="text-center">
        <button type="submit" class="btn btn-info" >
          <span class="glyphicon glyphicon-euro"></span>
          Paga con il credito
        </button>
        <button class="btn btn-info" >
          <span class="glyphicon glyphicon-credit-card"></span>
          Paga con PayPal
        </button>
      </div>
      {% endif %}

    </form>
</div>
{% endblock %}
